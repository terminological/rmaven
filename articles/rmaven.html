<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • rmaven</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rmaven</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/rmaven.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/terminological/rmaven/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/terminological/rmaven/blob/main/vignettes/rmaven.Rmd" class="external-link"><code>vignettes/rmaven.Rmd</code></a></small>
      <div class="hidden name"><code>rmaven.Rmd</code></div>

    </div>

    
    
<p>The purpose of <code>rmaven</code> is to simplify the process of
including Java libraries into R code for use by <code>rJava</code>.
Currently the <code>rJava</code> infrastructure assumes jar files of
compiled code, and all the dependencies thereof, are available locally
and known to the programmer. This works well if the <code>rJava</code>
code is part of a package, but less well if the user is programming in a
<code>REPL</code> loop, and simply wants to use a Java library.</p>
<p>Even when packaging Java libraries with <code>rJava</code> code into
an R package, the transitive dependencies of a moderately complicated
bit of Java code can be complex, and distributing the <code>jar</code>
files associated with that burdensome, particularly when the underlying
libraries are updated. The bundling of jar files also may exceed the
stringent CRAN policies for allowable package sizes, requiring a complex
distribution mechanism for the dependencies.</p>
<p>To solve this <code>rmaven</code> manages some or all of this problem
for you, by integrating Java’s standard build and dependency management
tool Apache Maven into R. This allows Java libraries used within R to be
specified as <code>Maven</code> artifacts and transitive dependencies
downloaded dynamically from Maven repositories. <code>rmaven</code> is
pure R with minimal dependencies of its own, apart from the existence of
a Java runtime (<code>JRE</code> or <code>JDK</code>) installed on the
system, and the location known to R. It doesn’t even require
<code>rJava</code> (although without it there doesn’t seem much
point).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://terminological.github.io/rmaven">rmaven</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/start_jvm.html">start_jvm</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The following 3 lines clears the local rmaven cache and is here to </span></span>
<span><span class="co"># create a clean slate before executing the rest of the vignette.</span></span>
<span><span class="co"># In normal use you would not call this in a non-interactive setting</span></span>
<span><span class="va">opts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"rmaven.allow.cache.delete"</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/clear_rmaven_cache.html">clear_rmaven_cache</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">opts</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="download-jar-files-using-maven">Download jar files using Maven<a class="anchor" aria-label="anchor" href="#download-jar-files-using-maven"></a>
</h2>
<p>When using <code>rmaven</code> the first step to using a Java library
in R is to fetch it from the Maven repositories. The artifact
coordinates (i.e. <code>groupId</code>, <code>artifactId</code> and
<code>version</code>) of an specific Java library are easily found on
the internet. Maven manages bootstrapping the download of libraries.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># cache apache commons lang3 </span></span>
<span><span class="va">dynamic_classpath</span> <span class="op">=</span> <span class="fu"><a href="../reference/resolve_dependencies.html">resolve_dependencies</a></span><span class="op">(</span></span>
<span>  groupId <span class="op">=</span> <span class="st">"org.apache.commons"</span>, </span>
<span>  artifactId <span class="op">=</span> <span class="st">"commons-lang3"</span>, </span>
<span>  version<span class="op">=</span><span class="st">"3.12.0"</span>,</span>
<span>  verbose<span class="op">=</span><span class="st">"quiet"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Updating Java dependencies, please be patient.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Locally cached classpath of commons-lang3: %s"</span>,<span class="va">dynamic_classpath</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Locally cached classpath of commons-lang3: /home/runner/.cache/rmaven/.m2/repository/org/apache/commons/commons-lang3/3.12.0/commons-lang3-3.12.0.jar"</span></span>
<span></span>
<span><span class="co"># to get the one jar file many others are downloaded and cached as part of</span></span>
<span><span class="co"># bootstrapping the Java build tools</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Jar files found in repository: %1.0f"</span>, </span>
<span>        <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_repository_location.html">get_repository_location</a></span><span class="op">(</span><span class="op">)</span>,recurse <span class="op">=</span> <span class="cn">TRUE</span>,glob<span class="op">=</span><span class="st">"*.jar"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Jar files found in repository: 181"</span></span></code></pre></div>
<p>In Java development Maven manages a local repository in the
<code>.m2/repository/</code> subdirectory of the users home. In
<code>rmaven</code> however changing directories in the user space
conflicts with CRAN policies. As the purpose of this library is to
support Java use in R, it makes sense to move the
<code>.m2/repository/</code> cache directory to a CRAN approved
location, however this can be changed through configuration (see
<code>set_repository_location(...)</code> function).</p>
</div>
<div class="section level2">
<h2 id="caching-of-java-libraries">Caching of Java libraries<a class="anchor" aria-label="anchor" href="#caching-of-java-libraries"></a>
</h2>
<p>As we saw above <code>rmaven</code> bootstraps loading of Maven
itself and any plugins required. When doing this the code above triggers
a significant download. Maven is good at handling the caching of
downloads, and sharing reused artifacts. Repeated invocation of
<code>rmaven</code> will not require additional downloads.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># does not need additional downloads</span></span>
<span><span class="fu"><a href="../reference/resolve_dependencies.html">resolve_dependencies</a></span><span class="op">(</span></span>
<span>  groupId <span class="op">=</span> <span class="st">"org.apache.commons"</span>, </span>
<span>  artifactId <span class="op">=</span> <span class="st">"commons-lang3"</span>, </span>
<span>  version<span class="op">=</span><span class="st">"3.12.0"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/home/runner/.cache/rmaven/.m2/repository/org/apache/commons/commons-lang3/3.12.0/commons-lang3-3.12.0.jar"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Unchanged locally cached classpath of commons-lang3: %s"</span>,<span class="va">dynamic_classpath</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Unchanged locally cached classpath of commons-lang3: /home/runner/.cache/rmaven/.m2/repository/org/apache/commons/commons-lang3/3.12.0/commons-lang3-3.12.0.jar"</span></span>
<span></span>
<span><span class="co"># no additional downloads once cache populated</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Jar files found in repository: %1.0f"</span>, </span>
<span>        <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_repository_location.html">get_repository_location</a></span><span class="op">(</span><span class="op">)</span>,recurse <span class="op">=</span> <span class="cn">TRUE</span>,glob<span class="op">=</span><span class="st">"*.jar"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Jar files found in repository: 181"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-local-repository-jar-files-in-rjava">Using local repository Jar files in <code>rJava</code><a class="anchor" aria-label="anchor" href="#using-local-repository-jar-files-in-rjava"></a>
</h2>
<p>The second step is to add jars from the local <code>.m2</code>
repository to the <code>rJava</code> class path, and using
<code>rJava</code>, create an R interface to the Java class you want to
use (in this case the <code>StringUtils</code> class).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rJava</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rJava/man/loader.html" class="external-link">.jaddClassPath</a></span><span class="op">(</span><span class="va">dynamic_classpath</span><span class="op">)</span></span>
<span><span class="va">StringUtils</span> <span class="op">=</span> <span class="fu">rJava</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rJava/man/J.html" class="external-link">J</a></span><span class="op">(</span><span class="st">"org.apache.commons.lang3.StringUtils"</span><span class="op">)</span></span></code></pre></div>
<p>Finally you can call the static Java method, using
<code>rJava</code>, in this case
<code>StringUtils.rotate(String s, int distance)</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">StringUtils</span><span class="op">$</span><span class="fu">rotate</span><span class="op">(</span><span class="st">"ABCDEF"</span>,<span class="fl">3L</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "DEFABC"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="java-compilation">Java compilation<a class="anchor" aria-label="anchor" href="#java-compilation"></a>
</h2>
<p>Apart from using Maven to download manage dependencies, it also
allows us to compile Java code and integrate dependencies, specified in
a <code>pom.xml</code> file. By including Java code in an R project and
using Maven to compile code we raise the possibility of integrating Java
and R code in a manner similar to the way <code>RCpp</code> and
<code>C++</code>.</p>
<div class="section level3">
<h3 id="step-0-write-some-java-code">Step 0: write some java code<a class="anchor" aria-label="anchor" href="#step-0-write-some-java-code"></a>
</h3>
<p>As part of your package write some Java code including a
<code>pom.xml</code> Maven build file, such as the
<code>TestCass</code>, in the example code bundled with this
package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find the java source code example bundled with this package</span></span>
<span><span class="va">source_directory</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata/test-project"</span>,package <span class="op">=</span> <span class="st">"rmaven"</span><span class="op">)</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="va">source_directory</span>, invert<span class="op">=</span><span class="cn">TRUE</span>, glob <span class="op">=</span> <span class="st">"*/target/*"</span><span class="op">)</span></span>
<span><span class="co">#&gt; /home/runner/work/_temp/Library/rmaven/testdata/test-project</span></span>
<span><span class="co">#&gt; ├── pom.xml</span></span>
<span><span class="co">#&gt; └── src</span></span>
<span><span class="co">#&gt;     └── main</span></span>
<span><span class="co">#&gt;         └── java</span></span>
<span><span class="co">#&gt;             └── org</span></span>
<span><span class="co">#&gt;                 └── example</span></span>
<span><span class="co">#&gt;                     └── TestClass.java</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-1-compile-the-jar">Step 1: compile the jar<a class="anchor" aria-label="anchor" href="#step-1-compile-the-jar"></a>
</h3>
<p>We use <code>rmaven</code> to compile the Java source code. This
could possibly be done in an <code>.onLoad()</code> package function, if
you were developing a package which includes Java source code:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In this configuration rmaven will compile a single `fat-jar`</span></span>
<span><span class="va">compiled_jar</span> <span class="op">=</span> <span class="fu"><a href="../reference/compile_jar.html">compile_jar</a></span><span class="op">(</span><span class="va">source_directory</span>, with_dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Compiling Java library, please be patient.</span></span>
<span><span class="co">#&gt; [INFO] Scanning for projects...</span></span>
<span><span class="co">#&gt; [INFO]                                                                         </span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; [INFO] Building test project 0.0.1-SNAPSHOT</span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Using 'UTF-8' encoding to copy filtered resources.</span></span>
<span><span class="co">#&gt; [INFO] skip non existing resourceDirectory /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/src/main/resources</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Changes detected - recompiling the module!</span></span>
<span><span class="co">#&gt; [INFO] Compiling 1 source file to /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/target/classes</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-assembly-plugin:3.2.0:single (default-cli) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Building jar: /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/target/test-project-0.0.1-SNAPSHOT-jar-with-dependencies.jar</span></span>
<span><span class="co">#&gt; [INFO] Building jar: /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/target/test-project-0.0.1-SNAPSHOT-src.jar</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Using 'UTF-8' encoding to copy filtered resources.</span></span>
<span><span class="co">#&gt; [INFO] skip non existing resourceDirectory /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/src/main/resources</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Nothing to compile - all classes are up to date</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Not copying test resources</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Not compiling test sources</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Tests are skipped.</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Building jar: /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/target/test-project-0.0.1-SNAPSHOT.jar</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-assembly-plugin:3.2.0:single (trigger-assembly) @ test-project ---</span></span>
<span><span class="co">#&gt; [INFO] Building jar: /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/target/test-project-0.0.1-SNAPSHOT-jar-with-dependencies.jar</span></span>
<span><span class="co">#&gt; [INFO] Building jar: /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/target/test-project-0.0.1-SNAPSHOT-src.jar</span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; [INFO] BUILD SUCCESS</span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; [INFO] Total time: 8.581 s</span></span>
<span><span class="co">#&gt; [INFO] Finished at: 2026-02-12T10:25:54+00:00</span></span>
<span><span class="co">#&gt; [INFO] Final Memory: 20M/88M</span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Location of compiled jar from test source code in this repository: %s"</span>,<span class="va">compiled_jar</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Location of compiled jar from test source code in this repository: /home/runner/.cache/rmaven/org.example_test-project_0.0.1-SNAPSHOT/test-project-0.0.1-SNAPSHOT/target/test-project-0.0.1-SNAPSHOT-jar-with-dependencies.jar"</span></span>
<span></span>
<span><span class="co"># More plugins are required to perform the compilation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Jar files found in repository: %1.0f"</span>, </span>
<span>        <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_repository_location.html">get_repository_location</a></span><span class="op">(</span><span class="op">)</span>,recurse <span class="op">=</span> <span class="cn">TRUE</span>,glob<span class="op">=</span><span class="st">"*.jar"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Jar files found in repository: 269"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-use-the-jar">Step 2: use the jar<a class="anchor" aria-label="anchor" href="#step-2-use-the-jar"></a>
</h3>
<p>Once compiled we can use the Java code within R in a very similar
manner as before</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rJava</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rJava/man/loader.html" class="external-link">.jaddClassPath</a></span><span class="op">(</span><span class="va">compiled_jar</span><span class="op">)</span></span>
<span><span class="va">TestClass</span> <span class="op">=</span> <span class="fu">rJava</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rJava/man/J.html" class="external-link">J</a></span><span class="op">(</span><span class="st">"org.example.TestClass"</span><span class="op">)</span></span>
<span><span class="va">TestClass</span><span class="op">$</span><span class="fu">sayHelloWorld</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hello world!"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="options-and-configuration">Options and configuration<a class="anchor" aria-label="anchor" href="#options-and-configuration"></a>
</h2>
<p>Various options exist to control behaviour of the library. N.B. None
of the options in this section are executed as part of the vignette,
they are just here to document the options.</p>
<p>Set the level of information returned by Maven. Maven can be very
verbose so defaulting <code>rmaven</code> to “quiet” mode is often a
good idea.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"rmaven.quiet"</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Set the default repository URLs for fetching artifacts. these can
also be specified as options for the <code><a href="../reference/fetch_artifact.html">fetch_artifact()</a></code> and
<code><a href="../reference/copy_artifact.html">copy_artifact()</a></code> functions. E.g. to restrict to Maven
central:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"rmaven.default_repos"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://repo1.maven.org/maven2/"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># N.b. plan is to integrate this with settings.xml</span></span></code></pre></div>
<p>Manually set <code>JAVA_HOME</code> for Maven to use. The home
directory of the Java installation is detected automatically by firstly
checking this option, then the <code>JAVA_HOME</code> environment
variable, then the <code>LD_LIBRARY_PATH</code> environment variable,
then by asking <code>rJava</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"rmaven.java_home"</span><span class="op">=</span><span class="st">"/usr/lib/jvm/java-9-oracle"</span><span class="op">)</span></span></code></pre></div>
<p>Provide custom options to the JVM on startup, e.g. enabling
profiling, this needs to be set before <code><a href="../reference/start_jvm.html">start_jvm()</a></code> to have
any effect:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"java.parameters"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-Xprof"</span>,<span class="st">"-Xrunhprof"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Enable debug mode option has the dual effect of: starting the JVM in
debug mode (JVM flags:
<code>-Xdebug -Xrunjdwp:transport=dt_socket,address=8998,server=y,suspend=n</code>
), and asking Maven to print debugging output (Maven flags:
<code>-X -e</code>). This needs to be set before
<code><a href="../reference/start_jvm.html">start_jvm()</a></code> to have any effect.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"rmaven.debug"</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Configure location of the local m2 repository, e.g. to use the Java
default package location:</p>
<p>You might want to do this if you are a Java developer and you have a
maven cache already populated with locally built Java libraries from a
Java IDE and you are working to develop an R package pending deployment.
If you using <code>rmaven</code> for dependency management in a package
and you intend to submit it to CRAN, altering this setting for the
<code>rmaven</code> repository location will cause issues during CRAN
submission as the resulting package will touch the userspace and hence
violate CRAN’s policies.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># THIS IS NOT RUN (and nore are any of the other options documented </span></span>
<span><span class="co"># in this section)</span></span>
<span><span class="co"># options("rmaven.m2.repository"="~/.m2/repository/")</span></span></code></pre></div>
<p>Allow <code>rmaven</code> to programmatically delete all cached
files. This will involve a lot of downloading from maven central and
generally only required on a development machine where you want to make
sure everything runs from scratch (like in this vignette).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"rmaven.allow.cache.delete"</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># combined with clear_rmaven_cache()</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-else-could-you-do">What else could you do?<a class="anchor" aria-label="anchor" href="#what-else-could-you-do"></a>
</h2>
<ul>
<li>Run ant tasks. - using the <code>antrun</code> plugin</li>
<li>Initialize production web servers and ‘APIs’. - using Jetty or
Spring.</li>
<li>run any other maven plugin goal, for example:</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here we execute a maven help goal</span></span>
<span><span class="fu"><a href="../reference/execute_maven.html">execute_maven</a></span><span class="op">(</span><span class="st">"help:help"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [INFO] Scanning for projects...</span></span>
<span><span class="co">#&gt; [INFO]                                                                         </span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; [INFO] Building Maven Stub Project (No POM) 1</span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; [INFO] </span></span>
<span><span class="co">#&gt; [INFO] --- maven-help-plugin:3.3.0:help (default-cli) @ standalone-pom ---</span></span>
<span><span class="co">#&gt; [INFO] Apache Maven Help Plugin 3.3.0</span></span>
<span><span class="co">#&gt;   The Maven Help plugin provides goals aimed at helping to make sense out of the</span></span>
<span><span class="co">#&gt;   build environment. It includes the ability to view the effective POM and</span></span>
<span><span class="co">#&gt;   settings files, after inheritance and active profiles have been applied, as</span></span>
<span><span class="co">#&gt;   well as a describe a particular plugin goal to give usage information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This plugin has 8 goals:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; help:active-profiles</span></span>
<span><span class="co">#&gt;   Displays a list of the profiles which are currently active for this build.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; help:all-profiles</span></span>
<span><span class="co">#&gt;   Displays a list of available profiles under the current project.</span></span>
<span><span class="co">#&gt;   Note: it will list all profiles for a project. If a profile comes up with a</span></span>
<span><span class="co">#&gt;   status inactive then there might be a need to set profile activation</span></span>
<span><span class="co">#&gt;   switches/property.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; help:describe</span></span>
<span><span class="co">#&gt;   Displays a list of the attributes for a Maven Plugin and/or goals (aka Mojo -</span></span>
<span><span class="co">#&gt;   Maven plain Old Java Object).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; help:effective-pom</span></span>
<span><span class="co">#&gt;   Displays the effective POM as an XML for this build, with the active profiles</span></span>
<span><span class="co">#&gt;   factored in, or a specified artifact. If verbose, a comment is added to each</span></span>
<span><span class="co">#&gt;   XML element describing the origin of the line.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; help:effective-settings</span></span>
<span><span class="co">#&gt;   Displays the calculated settings as XML for this project, given any profile</span></span>
<span><span class="co">#&gt;   enhancement and the inheritance of the global settings into the user-level</span></span>
<span><span class="co">#&gt;   settings.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; help:evaluate</span></span>
<span><span class="co">#&gt;   Evaluates Maven expressions given by the user in an interactive mode.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; help:help</span></span>
<span><span class="co">#&gt;   Display help information on maven-help-plugin.</span></span>
<span><span class="co">#&gt;   Call mvn help:help -Ddetail=true -Dgoal=&lt;goal-name&gt; to display parameter</span></span>
<span><span class="co">#&gt;   details.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; help:system</span></span>
<span><span class="co">#&gt;   Displays a list of the platform details like system properties and environment</span></span>
<span><span class="co">#&gt;   variables.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; [INFO] BUILD SUCCESS</span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; [INFO] Total time: 4.573 s</span></span>
<span><span class="co">#&gt; [INFO] Finished at: 2026-02-12T10:26:00+00:00</span></span>
<span><span class="co">#&gt; [INFO] Final Memory: 16M/68M</span></span>
<span><span class="co">#&gt; [INFO] ------------------------------------------------------------------------</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="further-work">Further work<a class="anchor" aria-label="anchor" href="#further-work"></a>
</h2>
<ul>
<li>Maven shade plugin</li>
<li>Simplify multiple dependencies</li>
<li>Support creation of <code>pom.xml</code> files from R</li>
<li>Tools to maintain maven <code>settings.xml</code>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robert Challen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
